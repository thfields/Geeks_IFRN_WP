(()=>{var e={4670:(e,t,n)=>{"use strict";e.exports=n(5607)},9829:(e,t,n)=>{"use strict";var o,a,i,r=n(8946),s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function l(){i=!1}function c(e){if(e){if(e!==o){if(e.length!==s.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,n){return t!==n.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. These characters were not unique: "+t.join(", "));o=e,l()}}else o!==s&&(o=s,l())}function u(){return i||(i=function(){o||c(s);for(var e,t=o.split(""),n=[],a=r.nextValue();t.length>0;)a=r.nextValue(),e=Math.floor(a*t.length),n.push(t.splice(e,1)[0]);return n.join("")}())}e.exports={get:function(){return o||s},characters:function(e){return c(e),o},seed:function(e){r.seed(e),a!==e&&(l(),a=e)},lookup:function(e){return u()[e]},shuffled:u}},480:(e,t,n)=>{"use strict";var o,a,i=n(8416);n(9829),e.exports=function(e){var t="",n=Math.floor(.001*(Date.now()-1567752802062));return n===a?o++:(o=0,a=n),t+=i(7),t+=i(e),o>0&&(t+=i(o)),t+i(n)}},8416:(e,t,n)=>{"use strict";var o=n(9829),a=n(3766),i=n(296);e.exports=function(e){for(var t,n=0,r="";!t;)r+=i(a,o.get(),1),t=e<Math.pow(16,n+1),n++;return r}},5607:(e,t,n)=>{"use strict";var o=n(9829),a=n(480),i=n(1082),r=n(5636)||0;function s(){return a(r)}e.exports=s,e.exports.generate=s,e.exports.seed=function(t){return o.seed(t),e.exports},e.exports.worker=function(t){return r=t,e.exports},e.exports.characters=function(e){return void 0!==e&&o.characters(e),o.shuffled()},e.exports.isValid=i},1082:(e,t,n)=>{"use strict";var o=n(9829);e.exports=function(e){return!(!e||"string"!=typeof e||e.length<6||new RegExp("[^"+o.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(e))}},3766:e=>{"use strict";var t,n="object"==typeof window&&(window.crypto||window.msCrypto);t=n&&n.getRandomValues?function(e){return n.getRandomValues(new Uint8Array(e))}:function(e){for(var t=[],n=0;n<e;n++)t.push(Math.floor(256*Math.random()));return t},e.exports=t},8946:e=>{"use strict";var t=1;e.exports={nextValue:function(){return(t=(9301*t+49297)%233280)/233280},seed:function(e){t=e}}},5636:e=>{"use strict";e.exports=0},296:e=>{e.exports=function(e,t,n){for(var o=(2<<Math.log(t.length-1)/Math.LN2)-1,a=-~(1.6*o*n/t.length),i="";;)for(var r=e(a),s=a;s--;)if((i+=t[r[s]&o]||"").length===+n)return i}}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";n.r(o),n.d(o,{AIApiError:()=>G,AIDataProvider:()=>C,aiImageGenerateFromText:()=>le,aiImageMask:()=>ue,aiImageVariations:()=>ce,aiSearchImages:()=>ge,aiSearchedImageSave:()=>pe,categoriesToSectionsList:()=>Me,changeTextPrompt:()=>ie,determineSiteMood:()=>J,fillSectionTemplate:()=>Ye,findPattern:()=>O,generateColorScheme:()=>X,generatePageStructure:()=>Le,generatePageStructureApi:()=>H,generateSectionContent:()=>Z,generateSiteStructure:()=>Q,getAIInfo:()=>W,getAIUsage:()=>j,getBusinessTypes:()=>a,getContentLanguageStyles:()=>x,getContentLanguages:()=>v,getFromGenerationSession:()=>ke,getPageContentSectionTemplate:()=>Be,getPageFooterTemplate:()=>Re,getPageHederTemplate:()=>De,getPageSectionsTemplates:()=>Ve,initGenerationSession:()=>be,normalizeCategorySlug:()=>T.normalizeCategorySlug,normalizeSection:()=>_e,openConnectPopup:()=>l,optimizePrompt:()=>re,processContent:()=>oe,prompt:()=>ae,rephraseSectionContent:()=>ee,rephraseSectionTemplate:()=>qe,saveAiGeneralSettings:()=>$,searchImages:()=>te,searchVideo:()=>ne,setAIKey:()=>K,setInGenerationSession:()=>ye,textToImage:()=>se,useAIData:()=>w,useAIServiceInfo:()=>b,useIsAIConnected:()=>f});const e=window.kubio.utils,t=window.wp.i18n,a=()=>(0,e.getBackendData)("aiBusinessTypes",{natural:{label:(0,t.__)("Business","kubio"),value:"Business",description:(0,t.__)("Resources and insights for starting, managing, and growing businesses.","kubio")}}),i=window.wp.url,r=window.lodash;var s=n.n(r);const l=async()=>new Promise(((t,n)=>{const{screen:o}=window,a=(0,r.first)((0,e.getBackendData)("kubioCloudUrl").split("?")).replace(/\/+$/,""),s=["popup","innerWidth=500","innerHeight=600","left="+(o.width-500)/2,"top="+(o.height-600)/2*.8],l=(0,i.addQueryArgs)(`${a}/ui-route/connect-ai`,{key:""}),c=window.open(l,"kubioAIConnect",s.join(",")),u=e=>{const{action:o=null,value:a=null,error:i=null}=e.data||{};if("ai_subscription_key"===o){if(c.close(),window.removeEventListener("message",u),i)return n(n);t(a)}};window.addEventListener("message",u)})),c=window.wp.element,u=window.kubio.constants,g=window.kubio.core,p=window.kubio.editorData,d=window.kubio.globalData,m=window.wp.coreData,h=window.wp.data,f=()=>{const[t,n]=(0,p.useGlobalSessionProp)("isAIConnected",(0,e.getBackendData)("aiIsConnected",!1));return[t,n]},b=()=>{const e=(0,h.useSelect)((e=>e(u.STORE_KEY).getAIInfo())),{updateAIInfo:t}=(0,h.useDispatch)(u.STORE_KEY);return[e,t]},y=Object.freeze({}),k=(0,c.createContext)([y,r.noop]),w=()=>(0,c.useContext)(k),C=t=>{let{children:n}=t;const[o,a]=(0,p.useGlobalSessionProp)("aiGeneratorData",y),i=(0,p.useGetGlobalSessionProp)("ready",!1),{title:s}=(0,d.useSiteLogoImages)(),l=(0,g.usePageTitle)(),[b]=f(),{recordFallback:w,isFrontPage:C,pageContextFallback:v,frontPageEntity:x,blogPageEntity:T,otherPages:_}=(0,h.useSelect)((e=>{const{getCurrentPostType:t,getCurrentPostId:n,getIsFrontPage:o}=e(u.STORE_KEY),{getEntityRecord:a,getEntityRecords:i}=e(m.store),{page_for_posts:s,page_on_front:l}=a("root","site")||{},c=a("postType",t(),n()),g=l?a("postType","page",l):null,p=s?a("postType","page",s):null,d=(i("postType","page",{per_page:-1,exclude:[s,l,n()].filter(Boolean)})||[]).map((e=>({id:e.id,title:e.title.rendered})));return{recordFallback:c,pageContextFallback:(0,r.get)(c,["kubio_ai_page_context"],y),isFrontPage:o(),frontPageEntity:g,blogPageEntity:p,otherPages:d}}),[]),P=(0,e.getBackendData)("aiSettings"),I=(0,g.useDeepMemo)((()=>{var e,t;let{siteContext:n=null,pageContext:a=null,pageTitle:r=null,isRegenerate:c=!1,record:u=null}=o||{};n=n||P,a=a||v,r=r||l,u=u||w;const g=!n.structure_type||"multi-page"===n.structure_type;return{siteContext:{...n,business_name:null!==(e=null===(t=n)||void 0===t?void 0:t.business_name)&&void 0!==e?e:s,otherPages:_,isMultiPage:g},pageContext:i?{...a,title:r,isFrontPage:C}:{},isFrontPage:C,isRegenerate:c,record:u,pageTitle:r,isMultiPage:g,isAIConnected:b,frontPageEntity:x,blogPageEntity:T}}),[P,v,l,null==w?void 0:w.id,o,s,C,_,b,x,T]),S=(0,c.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a((n=>{const o=(0,r.cloneDeep)(e);return t?(0,r.set)((0,r.cloneDeep)(n),t,o):o}))}),[a]);return(0,c.createElement)(k.Provider,{value:[I,S]},n)},v=()=>(0,e.getBackendData)("aiLanguages",{en_EN:"English (US)"}),x=()=>(0,e.getBackendData)("aiLanguageStyles",{natural:{label:(0,t.__)("Natural","kubio"),description:(0,t.__)("Is the default language style. It can adapt to some extent depending on the cues from the user's input.","kubio")}}),T=window.kubio.blockPatterns,_=window.wp.blockEditor,P=window.kubio.log,I=(t,n)=>{const o=(0,r.get)(t,["kubioAI","meta","initialValues","words"],null);if(o)return o;const a=(0,r.get)(t,n,"");return(0,r.words)((0,e.stripTags)(a)).length},S=(t,n)=>{const o=(0,r.get)(t,["kubioAI","meta","initialValues","chars"],null);if(o)return o;const a=(0,r.get)(t,n,"");return(0,r.words)((0,e.stripTags)(a)).reduce(((e,t)=>e+t.length),0)},E=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=e.replace(/kubio(.*?)\//,""),t)switch(e){case"contact-info":case"contact-map":case"contact-form":e="contact"}return e},A=["blank-section"],O=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{tag:o,exclude:a,excludeWithTags:i=[],excludeSectionWithBackground:l,findBy:c=null,skippableTags:u=[],skipSlug:g=[],skipIds:p=[],returnAll:d=!1}=s().merge({exclude:[],excludeSectionWithBackground:!1,tag:null},n);t=(0,T.normalizeCategorySlug)(t);const m=(0,r.castArray)(o).filter(Boolean);let f=g;const b=[...u],y=E(t);switch(y){case"contact":i.push("contact-info","contact-map");break;case"contact-info":case"contact-map":case"contact-form":m.includes(y)||(m.push(y),u.push(y)),t="kubio-content/contact"}const k=(0,h.select)(_.store).getSettings().__experimentalBlockPatterns.filter((e=>e.isGutentagPattern));if(c){const e=(0,r.find)(k.filter((e=>!e.isProOnFree)),c);return e||P.Log.warn("Unable to find by",c),e}const w=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o="*"===t;if(p.includes(e.cloudPresetId))return!1;if(f.includes(e.name))return!1;if(o||(o=e.categories.find((e=>t===(0,T.normalizeCategorySlug)(e)))),!o)return!1;if(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=(0,T.getSectionSlugFromPattern)(e),a=(i=o,A.includes(i)||t.includes(o));var i;return!0===n?a||L(e.content[1]):a}(e,a,l))return!1;if(!(e=>((null==e?void 0:e.internalTags)||[]).includes("ai-ready"))(e))return!1;const s=[...e.publicTags||[],...e.internalTags||[]];return!i.some((e=>s.includes(e)))&&(!!(0,r.difference)(m,n).every((e=>s.includes(e)))&&!e.isProOnFree)};let C=k.filter((e=>w(e)));if((0,r.isEmpty)(C)&&(f=[],C=k.filter((t=>w(t,b.concat((0,e.getBackendData)("sectionStylesTags")))))),d)return C;const v=(0,r.sample)(C);return v?(P.Log.info(`Pattern found: ${v.slug}`),s().cloneDeep(v)):null};function L(e){if(!e)return!1;const t=["kubio","style","descendants",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"outer","background"],n=(0,r.get)(e,[...t,"type"]);return!!["image","slideshow"].includes(n)}function D(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return!n||n.isFrontPage||("team"===n.purpose&&"team"===t&&e.push("dedicated-page"),"gallery"===n.purpose&&"photo-gallery"===t&&e.push("dedicated-page"),"portfolio"===n.purpose&&"portfolio"===t&&e.push("dedicated-page")),e}const R=(e,t)=>{let n=!1;if(t.isFrontPage)n=!0;else switch(e){case"team":n="team"!==t.purpose;break;case"portfolio":n="portfolio"!==t.purpose;break;case"photo-gallery":n="gallery"!==t.purpose}return[n?"dedicated-page":null].filter(Boolean)},F=window.wp.apiFetch;var B=n.n(F);const z=window.wp.hooks,M=window.wp.notices,V=e=>e.map((e=>{const t=(e.elements||[]).map((e=>(0,r.omit)(e,["path","attributePath"])));return{...e,elements:t}}));var N=n(4670),U=n.n(N);class G extends Error{}const Y=function(e){var t,n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==(t=e=(0,r.cloneDeep)(e))&&void 0!==t&&null!==(n=t.siteContext)&&void 0!==n&&n.cta&&(0,r.unset)(e,["siteContext","cta"]),{...e,remainingRetries:o.retries||null}},q=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:o="POST",skipCreditsCheck:a=!1,retries:s=2,__kubio_call_id:l=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{updateAIInfo:c=r.noop}=(0,h.dispatch)(u.STORE_KEY)||{},{getAIInfo:g=r.noop}=(0,h.select)(u.STORE_KEY)||{},p=l||U().generate();let d,m=a;if(!m){const{remainingCredits:e=0}=g()||{};m=e>0}if(!m)throw(0,z.doAction)("kubio.ai.zero_credits"),new G((0,t.__)("Your account has insufficient credits","kubio"),{cause:"zero_credits"});let f="";try{const t=await B()({path:(0,i.addQueryArgs)(`/kubio/v1/ai/${e}`,{__kubio_call_id:p}),method:o,data:Y(n,{retries:s})});f=t.upgrade_key||"",d=t.content;const a=(0,r.get)(t,"service_info.remaining_credits",null);(0,r.isNull)(a)||c({...g(),remainingCredits:a})}catch(i){const l=504===parseInt(i.code)||(i.code+"").startsWith("ai_service:");if("ai_service:pexels_request"===i.code&&!s)return P.Log.error("Kubio AI: API error",i,d),null;if("ai_service:invalid_element"===i.code&&!s)return P.Log.warn("Kubio AI: No retry managed to fixed generate elements problem. Return last result as is",i,d),(0,r.get)(i,"data.content",null);if(l&&s)return P.Log.warn(`AI service failed. ${s} retries left`,i),await q(e,n,{method:o,skipCreditsCheck:a,retries:s-1,__kubio_call_id:p});if("zero_credits"===i.code)throw(0,z.doAction)("kubio.ai.zero_credits"),new G((0,t.__)("Your account has insufficient credits","kubio"),{cause:"zero_credits"});const c=(0,t.__)("There was an error with the KubioAI services. If the error persists, please contact support","kubio");throw(0,h.dispatch)(M.store).createErrorNotice((0,t.sprintf)(// translators: %s is the error text
(0,t.__)("Kubio AI: %s","kubio"),c),{id:"kubio-ai-api-fetch-error",type:"snackbar"}),P.Log.error("Kubio AI: API error",i,d),new G(c,{cause:i.code})}return f&&(top.kubioAIUpgradeKey=f),d},K=async e=>{let{aiKey:t}=e;return await q("set-ai-key",{key:t},{skipCreditsCheck:!0})},W=async()=>await q("info",{},{skipCreditsCheck:!0}),j=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return await q("usage",{page:e,perPage:t},{skipCreditsCheck:!0})},$=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s().set(window.kubioUtilsData,"aiSettings",(0,r.cloneDeep)(e)),await q("settings",{settings:e},{skipCreditsCheck:!0})},H=async function(){let{pageTitle:e,allowedSections:t,siteContext:n,pageContext:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await q("generate-page-structure",{pageTitle:e,siteContext:n,pageContext:o,allowedSections:t})},Q=async function(){let{siteContext:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await q("generate-site-structure",{siteContext:e})},J=async function(){let{siteContext:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mood:t=u.SITE_MOOD_VALUES.NEUTRAL,subject:n="",owner_type:o="organization",client_type:a="both",call_to_action:i,core_business:r=""}=await q("determine-site-mood",{siteContext:e});let s=t.toLowerCase();switch(s){case"serious":case u.SITE_MOOD_VALUES.PROFESSIONAL:s=u.SITE_MOOD_VALUES.PROFESSIONAL;break;case"joyful":case u.SITE_MOOD_VALUES.PLAYFUL:s=u.SITE_MOOD_VALUES.PLAYFUL;break;default:s=u.SITE_MOOD_VALUES.NEUTRAL}return{mood:s,websiteSubject:n,ownerType:o,clientType:a,cta:i,coreBusiness:r.replace(/\W+/g," ").replace(/\s+/g," ")}},X=async function(){let{pageTitle:e,siteContext:t,pageContext:n,mood:o="neutral",primaryColors:a={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await q("generate-color-scheme",{pageTitle:e,siteContext:t,pageContext:n,mood:o,primaryColors:a},{retries:5})},Z=async function(){let{category:e,structure:t,pageTitle:n,siteContext:o,pageContext:a,summary:i,rules:r=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await q("generate-section-content",{category:e,structure:V(t),pageTitle:n,siteContext:o,pageContext:a,summary:i,rules:r})},ee=async function(){let{category:e,structure:t,pageTitle:n,siteContext:o,pageContext:a,summary:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await q("rephrase-section-content",{category:e,structure:V(t),pageTitle:n,siteContext:o,pageContext:a,summary:i})},te=async function(){let{search:e,initialImage:t="",perPage:n=10,page:o=1,mediaAttrs:a=null,width:i=null,height:s=null,orientation:l=null,color:c=null,skipOrientation:u=!1,crop:g=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!(0,r.isString)(e)||(0,r.isEmpty)(e)?(P.Log.error("Image search stopped early, the search param should be a non-empty string",new TypeError,e),{items:[]}):await q("search-image",{search:e,initialImage:t,perPage:n,page:o,mediaAttrs:a,width:i,height:s,orientation:l,color:c,skipOrientation:u,crop:g})},ne=async function(){let{search:e,perPage:t=10,page:n=1,mediaAttrs:o=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await q("search-video",{search:e,perPage:t,page:n,mediaAttrs:o})},oe=async e=>{let{pageTitle:t,siteContext:n,pageContext:o,content:a,action:i,extras:r={}}=e;return await q("process-text",{pageTitle:t,siteContext:n,pageContext:o,content:a,action:i,extras:r})},ae=async e=>{let{pageTitle:t,siteContext:n,pageContext:o,prompt:a,originalContent:i,short:r,type:s="text"}=e;return await q("prompt",{pageTitle:t,siteContext:n,pageContext:o,prompt:a,originalContent:i,short:r,type:s})},ie=async e=>{let{pageTitle:t,siteContext:n,pageContext:o,promptData:a,text:i,type:r="text"}=e;return await q("change-text",{pageTitle:t,siteContext:n,pageContext:o,promptData:a,text:i,type:r})},re=async e=>{let{prompt:t}=e;return await q("summarize-prompt",{prompt:t})},se=async e=>{let{pageTitle:t,siteContext:n,pageContext:o,prompt:a,initialImage:i,imageSize:r}=e;return await q("prompt-to-image",{pageTitle:t,siteContext:n,pageContext:o,prompt:a,initialImage:i,imageSize:r})},le=async e=>{let{imagePrompt:t,initialImage:n,imageSize:o,imageStyle:a,imageType:i,numberOfImages:r,aspectRatio:s}=e;return await q("generate-text-to-image",{imagePrompt:t,initialImage:n,imageSize:o,imageStyle:a,imageType:i,numberOfImages:r,aspectRatio:s})},ce=async e=>{let{imagePrompt:t,currentSelectedImage:n,imageSize:o,imageStyle:a,imageType:i,numberOfImages:r}=e;return await q("generate-image-variations",{imagePrompt:t,currentSelectedImage:n,imageSize:o,imageStyle:a,imageType:i,numberOfImages:r})},ue=async e=>{let{imagePrompt:t,currentSelectedImage:n,maskImage:o}=e;return await q("image-mask",{imagePrompt:t,currentSelectedImage:n,maskImage:o})},ge=async function(){let{search:e,perPage:t=10,page:n=1,initialImage:o="",imageSize:a="medium",imageOrientation:i="portrait",aiPrompt:r=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await q("ai-search-images",{search:e,perPage:t,page:n,imageSize:a,imageOrientation:i,initialImage:o,aiPrompt:r})},pe=async e=>{let{selectedImage:t}=e;return await q("save-image",{selectedImage:t},{skipCreditsCheck:!0})},de=[{blocks:["kubio/image-gallery"],elements:["gallery"],transform:e=>{let{path:t,addColumnElement:n}=e;n({name:"gallery",path:t})},setter:async(e,n,o)=>{const a=(0,r.get)(e,[...o.path,2],[]);if(a.length)try{const{query:i=null,caption:s="",color:l=null}=n||{},c=(0,r.get)(e,[...o.path,1,"kubio","props","showMasonry"]),u=await te({search:i,skipOrientation:c,crop:!c,initialImage:c?void 0:(0,r.get)(a[0],[1,"url"]),perPage:a.length,mediaAttrs:["alt"],color:l});if(u.items){const n=[];for(let e=0;e<a.length;e++){const o=u.items[e%u.items.length];n.push({alt:"",caption:(0,t.sprintf)(s,e+1),id:0,url:o.url})}(0,r.set)([...o.path,1,"imagesData"],n);for(let t=0;t<a.length;t++){const a=[...o.path,2,t,1],i=(0,r.get)(e,a);(0,r.set)(e,a,{...i,...n[t]})}}}catch(e){P.Log.error(e)}}},{blocks:["kubio/pricing"],elements:["price"],transform:e=>{let{block:[,t],path:n,addColumnElement:o}=e;o({name:"price",path:n,on_sale:t.sale})},setter:async(e,t,n)=>{const{currentPrice:o=100,originalPrice:a=null}=t||{},i=parseInt(o)||100,s=a||i;(0,r.set)(e,[...n.path,1,"currentPrice"],i),(0,r.set)(e,[...n.path,1,"originalPrice"],s)}},!1].filter(Boolean);let me={};const he=new Set;let fe=!0;const be=()=>{fe&&(fe=!1,me={});const e="session-"+he.size;return he.add(e),()=>{he.delete(e),0===he.size&&(fe=!0,me={})}},ye=(e,t)=>{fe?P.Log.error("Generation session is not started"):(0,r.set)(me,e,t)},ke=(e,t)=>fe?(P.Log.error("Generation session is not started"),t):(0,r.get)(me,e,t),we=function(){let{attributes:e,path:t,addColumnElement:n,descendant:o,newColumn:a=r.noop}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=["kubio","style","descendants",o,"background"],s=(0,r.get)(e,[...i,"type"]);if(["image","slideshow","video"].includes(s)&&a(),"image"===s&&n({name:"backgroundImage",path:t,attributePath:[...i,"image","0","source","url"]}),"slideshow"===s){const o=(0,r.get)(e,[...i,"slideshow","slides"],Array.from({length:3})).length;for(let e=0;e<o;e++)n({name:"backgroundSlideshow",path:t,attributePath:[...i,"slideshow","slides",e,"url"]})}"video"===s&&n({name:"backgroundVideo",path:t,attributePath:[...i,"video"]})},Ce=[{blocks:["kubio/section","kubio/hero","kubio/navigation","kubio/navigation-section","kubio/navigation-top-bar"],transform:e=>{let{block:[,t],path:n,newColumn:o,addColumnElement:a}=e;we({attributes:t,path:n,addColumnElement:a,newColumn:o,descendant:"outer"})}},{blocks:["kubio/row"],transform:e=>{let{block:[,t,n],context:o,path:a,addColumnElement:i,newColumn:s}=e;o.section_header=(0,r.get)(t,"kubio.props.meta.isHeader",!1),2===a.length&&(o.list_items=(0,r.get)(t,"kubio.props.layout.equalWidth")&&n.length>1),we({attributes:t,path:a,addColumnElement:i,newColumn:s,descendant:"container"}),o.section_header&&s()}},{blocks:["kubio/column","kubio/pricing-table-item","kubio/slider-item","kubio/carousel-item","kubio/navigation-top-bar","kubio/navigation-items","kubio/navigation-sticky-items","kubio/flipbox","kubio/flipboxcontent","kubio/flipboxhover"],transform:e=>{let{block:[t,n],path:o,newColumn:a,addColumnElement:i,context:s}=e,l="inner";switch(t){case"kubio/column":const e=s.isTemplatePart?5:4;o.length!==e||s.section_header||a({short_desc:(0,r.get)(n,["kubioAI","desc"],null)});break;case"kubio/pricing-table-item":case"kubio/slider-item":case"kubio/carousel-item":a({is_pricing:"kubio/pricing-table-item"===t,is_slider:"kubio/slider-item"===t||"kubio/carousel-item"===t,list_items:!0});break;case"kubio/flipbox":return a({flipbox:!0}),we({attributes:n,path:o,addColumnElement:i,descendant:"container"}),we({attributes:n,path:o,addColumnElement:i,descendant:"normal"}),void we({attributes:n,path:o,addColumnElement:i,descendant:"hover"});case"kubio/flipboxcontent":case"kubio/flipboxhover":l="container";break;default:a()}we({attributes:n,path:o,addColumnElement:i,descendant:l})}},{blocks:["kubio/heading","kubio/text"],transform:e=>{let{block:[t,n],path:o,addColumnElement:a,includeContent:i}=e;const s={name:"kubio/heading"===t?"heading":"paragraph",path:o,attributePath:["content"],words:I(n,"content"),chars:S(n,"content")};"kubio/heading"===t&&(s.level=(0,r.get)(n,"kubio.props.level",2)),!0===i&&(s.text=n.content||""),a(s)}},{blocks:["kubio/button","kubio/link"],transform:e=>{let{block:[,t],path:n,addColumnElement:o,includeContent:a}=e;const i={name:"button",path:n,attributePath:["text"]};!0===a&&(i.text=t.content||""),o(i)}},{blocks:["kubio/multipleimagespicture","kubio/image"],transform:e=>{let{path:t,addColumnElement:n}=e;n({name:"image",path:t,attributePath:["url"]})}},{blocks:["kubio/tabitem","kubio/accordionitem"],walkChildren:!1,transform:e=>{let{block:[,t,n],path:o,addColumnElement:a,context:i,includeContent:s}=e;a({name:"question",path:o,attributePath:["title"],words:I(t,"title"),chars:S(t,"title")});let l=n[0];if(l){var c;const e=[],t=t=>e.push(t);null===(c=xe(l[0]))||void 0===c||c.transform({block:l,path:[...o,2,0],context:i,addColumnElement:t,includeContent:s}),l=e[0],(0,r.isEmpty)(l)||a({...e[0],name:"answer"})}}},{blocks:["kubio/counter"],transform:e=>{let{block:[,t],path:n,addColumnElement:o}=e;o({name:"counter",path:n,attributePath:[],words:I(t,"title"),chars:S(t,"title")})}},{blocks:["kubio/iconlistitem"],transform:e=>{let{block:[,t],path:n,addColumnElement:o}=e;const a=I(t,"text");a&&o({name:"list-item",path:n,attributePath:["text"],words:a})}},{blocks:["kubio/video"],transform:e=>{let{path:t,addColumnElement:n}=e;n({name:"video",path:t,attributePath:["internalUrl"]})}}],ve=[{elements:["image","backgroundImage","backgroundSlideshow"],setter:async function(e,t,n){let{siteContext:o,pageContext:a,sectionCategory:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=[...n.path,1,...n.attributePath];if(!(t=(0,r.isString)(t)?t.toLowerCase().replace(/\W+/g," ").replace(/\s+/g," "):null))return;t=(0,r.first)(t.split(",").map((e=>e.trim().toLowerCase())));const l=(0,r.get)(e,s,""),c=[...n.path,1,"kubioAI"];if("backgroundSlideshow"===n.name){const n=(0,r.get)(e,[...c,"slideshowTerms"],[]);(0,r.set)(e,[...c,"slideshowTerms"],[...n,t])}else(0,r.set)(e,[...c,"imageTerms"],t);try{const o=ke("previousQueries",new Map);let a=null;var u;o.has(t)?(a=o.get(t),P.Log.info(`Using cached image searches for "${t}"`)):(a=await te({search:t,initialImage:l,mediaAttrs:["id"],perPage:30,crop:null==n||null===(u=n.columnContext)||void 0===u?void 0:u.list_items}),o.set(t,a),ye("previousQueries",o));const i=ke("images",[]);let c=(a.items||[]).filter((e=>!i.includes(e.id)));c.length||(c=a.items||[]);const g=(0,r.first)(c);g&&(ye("images",[...i,g.id]),(0,r.set)(e,s,g.url))}catch(e){P.Log.error("Template element image setter",e)}}},{elements:["counter"],setter:async(e,t,n)=>{const{title:o=null,maxValue:a=null}=t||{};o&&(0,r.set)(e,[...n.path,1,"title"],o),a&&((0,r.set)(e,[...n.path,1,"amount"],a),(0,r.set)(e,[...n.path,1,"final"],a))}},{elements:["video","backgroundVideo"],setter:async(e,t,n)=>{try{var o;const a=await ne({search:t,perPage:1}),{video:s=null,poster:l=null}=(null==a||null===(o=a.items)||void 0===o?void 0:o[0])||{};if(s){let t=null;"video"===n.name&&(t=["internalUrl"],(0,r.set)(e,[...n.path,1,"videoCategory"],"internal"),(0,r.set)(e,[...n.path,1,...t],(0,i.addQueryArgs)(s,{_k_ext_fields:".mp4"}))),"backgroundVideo"===n.name&&(t=[...n.attributePath,"internal"],(0,r.set)(e,[...n.path,1,,...n.attributePath,"type"],"internal"),(0,r.set)(e,[...n.path,1,...t],{url:(0,i.addQueryArgs)(s,{_k_ext_fields:".mp4"})}))}if(l){let t=null;"video"===n.name&&(t=["posterImage"],(0,r.set)(e,[...n.path,1,...t],{url:l})),"backgroundVideo"===n.name&&(t=[...n.attributePath,"poster"],(0,r.set)(e,[...n.path,1,...t],{url:l}))}}catch(e){P.Log.error("Template element video setter",e)}}}],xe=e=>{for(let t=0;t<Ce.length;t++)if(Ce[t].blocks.includes(e))return Ce[t];for(let t=0;t<de.length;t++)if(de[t].blocks.includes(e))return de[t]};function Te(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const[o,,a=[]]=e;t(e,n),(0,r.get)(xe(o),"walkChildren",!0)&&a.forEach(((e,o)=>{Te(e,t,[...n,2,o])}))}const _e=function(e,t){let{includeContent:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=["kubio/header","kubio/sidebar","kubio/footer"].includes(e[0]),a=[],i={sectionCategory:t,includeContent:n,isTemplatePart:o},s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.push({context:(0,r.merge)((0,r.cloneDeep)(i),e),elements:[],type:"column"})};return Te(e,(function(t,o){var l;const[c,u]=t;null===(l=xe(c))||void 0===l||l.transform({block:t,path:o,context:i,newColumn:s,addColumnElement:t=>(t=>{try{a[a.length-1].elements.push({id:(n=t,(n.name||"el")+"-"+U()()+"-"+U()()),...t})}catch(n){P.Log.error("Kubio AI: Error element to column",n,[e,t])}var n})({...t,short_desc:(0,r.get)(u,["kubioAI","desc"],null)}),includeContent:n})})),a.filter((e=>e.elements.length))},Pe=window.kubio.blockLibrary,Ie=["hero-accent","about","content","features","counters","photo-gallery","portfolio","pricing","testimonials","clients","team","cta","f.a.q.","blog","contact"],Se={homepage:["hero-accent","about","content","features","counters","photo-gallery","portfolio","pricing","testimonials","clients","team","cta","f.a.q.","blog","contact"],general:["about","content","features","counters","photo-gallery","testimonials","clients","cta"],about:["about","content","features","counters","photo-gallery","clients","testimonials","team","cta"],services:["about","content","features","counters","photo-gallery","testimonials","clients","cta","f.a.q.","contact"],features:["about","content","features","counters","photo-gallery","testimonials","clients","cta","f.a.q."],portfolio:["portfolio","clients","cta"],team:["team","cta"],gallery:["photo-gallery","cta"],faq:["f.a.q.","cta"],pricing:["about","pricing","testimonials"],contact:["contact-info","contact-map","contact-form"]},Ee=["homepage","portfolio","team","gallery","faq","pricing","contact"],Ae={general:[],services:['Each service offered by the business will be placed in a separate "content" section.']},Oe=(0,Pe.getNamesOfBlocks)(),Le=async e=>{let{pageTitle:t,siteContext:n,pageContext:o,rules:a=[]}=e,i=(null==o?void 0:o.purpose)||"general";null!=o&&o.isFrontPage&&(i="homepage");let s=[];s=(Se[i]||Ie).filter((e=>!!O(`kubio-content/${e}`))),s=s.filter((e=>{switch(e){case"clients":if("people"===n.clientType||"individual"===n.clientType)return!1;break;case"team":if("individual"===n.ownerType)return!1;break;default:return!0}return!0})),a.length||(a=Ae[i]||[]);const l=await H({pageTitle:t,siteContext:n,pageContext:{...o,sortSections:o.hasOwnProperty("sortSections")?o.sortSections:Ee.includes(i)},allowedSections:s,rules:a});if(s.includes("cta")&&!(0,r.find)(l,{category:"cta"})){let e=null;if(s.forEach(((t,n)=>{n+1<s.length&&"cta"===s[n+1]&&(e=t)})),e){const t=(0,r.findLastIndex)(l,{category:e});t>-1&&l.splice(t+1,0,{category:"cta",summaries:[(0,r.get)(n,"cta.text","")]})}}return l},De=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],{tag:o=[],skipSlugs:a=[]}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e,l=[],c=null,g=null,p=null,d=!1;const m=n?u.FRONT_HEADERS_CATEGORY:u.INNER_HEADERS_CATEGORY;if(!i){const e=O(m,{tag:o,skipSlugs:a});if(!e)return null;p=e.name,d=[...e.publicTags||[],...e.internalTags||[]].includes("overlappable"),g=e.pairCloudPresetId,i=(0,r.get)(e,["content"]);const t=(0,r.get)(e,["context","theme","colors"],null);c=(0,r.cloneDeep)((0,r.get)(e,["context","theme","globalStyle","style","descendants","body"],null)),s().unset(c,["typography","holders","input"]),l=t?(0,r.map)(t,(e=>e)):t}const h=i[2],f=(0,r.cloneDeep)(h.find((e=>e[0]===Oe.NAVIGATION))),b=(0,r.cloneDeep)(h.find((e=>e[0]===Oe.HERO)));f&&((0,r.set)(f,[1,"attrs","name"],(0,t.__)("Navigation","kubio")),(0,r.set)(f,[1,"anchor"],"navigation")),b&&((0,r.set)(b,[1,"attrs","name"],(0,t.__)("Hero","kubio")),(0,r.set)(b,[1,"anchor"],"hero"));let y=null;var k;return g&&(y=O(n?u.INNER_HEADERS_CATEGORY:u.FRONT_HEADERS_CATEGORY,{findBy:{cloudPresetId:g}}),y=(null===(k=y)||void 0===k?void 0:k.content)||null),{category:m,navigation:f,hero:b,colors:l,bodyStyle:c,pairTemplate:y,pairCloudPresetId:g,name:p,overlappable:d}},Re=function(){let{tags:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=O(u.FOOTER_CATEGORY,{tags:e});return t?t.content:null},Fe=(e,t)=>({cloudPresetId:e.cloudPresetId,category:t,template:e.content,title:e.title,slug:(0,T.getSectionSlugFromPattern)(e),pairCloudPresetId:e.pairCloudPresetId,name:e.name,internalTags:e.internalTags,publicTags:e.publicTags}),Be=e=>{let{category:t="section",siteContext:n=null,findBy:o=null,tags:a=[],skippableTags:i=[],excludeWithTags:r=[],skipIds:l=[],returnAll:c=!1}=e;const u=[...a,s().get(n,"sections_tag")],g=O("section"===t?"*":`kubio-content/${t}`,{tag:u,findBy:o,skippableTags:i,excludeWithTags:r,skipIds:l,returnAll:c});return c?g.map((e=>Fe(e,t))):g?Fe(g,t):null},ze=e=>"content"===e.category||!![...e.internalTags,...e.publicTags].includes("dedicated-page"),Me=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o={},a=[];for(let i=0;i<e.length;i++){const{category:s,summaries:l}=e[i],c=(0,r.get)(o,[s],{count:0,pair:null});let u=null;if(null!==c.pair){const e=c.count%c.pair.length;u={cloudPresetId:c.pair[e]}}const g=Be({category:s,siteContext:t,findBy:u,tags:D([],s,n),skippableTags:D([],s,n),excludeWithTags:R(s,n)});if(!g)continue;const p=e.reduce(((e,t,n)=>(t.category===s&&e.push(n),e)),[]),d=l[p.indexOf(i)%l.length]||"";g.pairCloudPresetId&&ze(g)&&1===p.length&&e.splice(i+1,0,{category:s,summaries:l.filter((e=>e!==d))}),a.push({...g,summaries:[d]});let m=c.pair;!m&&g.pairCloudPresetId&&(m=[g.cloudPresetId,g.pairCloudPresetId]),(0,r.set)(o,[s],{count:m?c.count+1:0,pair:m})}return a},Ve=async e=>{let{pageTitle:t,siteContext:n,pageContext:o}=e;const a=await Le({pageTitle:t,siteContext:n,pageContext:o}),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=[],a=s().get(t,"sections_tag");return n.isFrontPage,e.filter((e=>e.template)).forEach((e=>{var t,i,r,s,l,c;o.push({...e,summary:(null===(t=e.summaries||[])||void 0===t||null===(i=t.pop)||void 0===i?void 0:i.call(t))||""});const u=1===o.length&&L(o[0].template[1]),g=o.length>=2&&L(null===(r=o.at(-1))||void 0===r||null===(s=r.template)||void 0===s?void 0:s[1])&&L(null===(l=o.at(-2))||void 0===l||null===(c=l.template)||void 0===c?void 0:c[1]);if(u||g){o.pop();const t=O("kubio-content/"+e.category,{exclude:[e.slug],excludeSectionWithBackground:!0,tag:D(a,e.category,n),excludeWithTags:R(e.category,n),skippableTags:D([],e.category,n)});var p,d;t&&o.push({...e,category:e.category,template:t.content,title:t.title,name:t.name,summary:(null===(p=e.summaries||[])||void 0===p||null===(d=p.pop)||void 0===d?void 0:d.call(p))||""})}})),o.map((e=>{let{summaries:t,...n}=e;return n}))}(Me(a,n,o),n,o).filter(Boolean);return i},Ne=async function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=(e=>{for(let n=0;n<ve.length;n++){var t;if(ve[n].elements.includes(e))return null===(t=ve[n])||void 0===t?void 0:t.setter}for(let t=0;t<de.length;t++){var n;if(de[t].elements.includes(e))return null===(n=de[t])||void 0===n?void 0:n.setter}})(n.name);a?await a(e,t,n,o):t&&(e=(0,r.set)(e,[...n.path,1,...n.attributePath],t));const i=["words","chars"];for(const t of i)n.hasOwnProperty(t)&&(e=(0,r.set)(e,[...n.path,1,"kubioAI","meta","initialValues",t],n[t]));return t},Ue=async t=>{let{structure:n,label:o,anchor:a,data:i,sectionTemplate:s,category:l,summary:c="",siteContext:u,pageContext:g}=t;const p=[],d=(e=>{const t={};return e.forEach((e=>{e.elements.forEach((n=>{t[n.id]={...n,columnContext:e.context}}))})),t})(n),m=[];try{for(let e=0;e<i.length;e++){const t=i[e],n=d[t.id];n&&(p.push(Ne(s,t.content,n,{siteContext:u,pageContext:g,sectionCategory:l})),m.push({name:n.name,structure:n,content:t.content}))}await Promise.all(p),(0,r.set)(s,[1,"kubioAI","meta","category"],E(l,!0)),(0,r.set)(s,[1,"kubioAI","meta","summary"],c)}catch(e){throw P.Log.error("Error in filling section with data",{category:l,template:s,elements:d}),e}return(0,r.set)(s,[1,"attrs","name"],o),(0,r.set)(s,[1,"anchor"],a),[(0,e.refreshBlockStyleRefs)(s),m]},Ge=(e,t)=>{var n;const o=[];var a;return"cta"===e&&null!=t&&null!==(n=t.cta)&&void 0!==n&&n.text&&o.push(`For the main header in the section use the following content, translated in the site language: "${null==t||null===(a=t.cta)||void 0===a?void 0:a.text}"`),o},Ye=async function(){let{template:e,category:t,pageTitle:n,siteContext:o,pageContext:a,summary:i="",label:s="",anchor:l="",includeContent:c=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const u=(0,r.cloneDeep)(e),g=_e(u,t,{includeContent:c});if((0,r.isEmpty)(g))return[u,[]];const p=await Z({category:t,structure:g,pageTitle:n,siteContext:o,pageContext:a,summary:i,rules:Ge(t,o)});return await Ue({structure:g,label:s,anchor:l,data:p,sectionTemplate:u,category:t,summary:i,siteContext:o,pageContext:a})},qe=async function(){let{template:e,category:t,pageTitle:n,siteContext:o,pageContext:a,summary:i="",label:s="",anchor:l="",includeContent:c=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const u=(0,r.cloneDeep)(e),g=_e(u,t,{includeContent:c}),p=await ee({category:t,structure:g,pageTitle:n,siteContext:o,pageContext:a,summary:i,rules:Ge(t,o)});return await Ue({structure:g,label:s,anchor:l,data:p,sectionTemplate:u,category:t,summary:i,siteContext:o,pageContext:a})}})(),(window.kubio=window.kubio||{}).ai=o})();
